# Multi FEA summary: example input data and output report

> The gene expression data used in this example is from: 
>
> Pinto SM, Subbannayya Y, Kim H, Hagen L, Górna MW, Nieminen AI, Bjørås M, Espevik T, Kainov D, Kandasamy RK. Multi-OMICs landscape of SARS-CoV-2-induced host responses in human lung epithelial cells. iScience. 2023 Jan 20;26(1):105895. doi: 10.1016/j.isci.2022.105895. Epub 2022 Dec 28. PMID: 36590899; PMCID: PMC9794516.

> **IMPORTANT**
>
> If you have already created a single FEA summary report using [this example data](https://avigailtaylor.github.io/GeneFEAST/example_usage.md), you still need to
> **download all of the following files** for this multi FEA summary example. All but one of the files below are similarly named, but different to those provided for the 
> [single FEA summary example](https://avigailtaylor.github.io/GeneFEAST/example_usage.md), with the only overlapping file being the [3 hour timepoint genes of interest file](https://avigailtaylor.github.io/GeneFEAST/mmc2_goi_3h.csv)

---
### Download the following example input files:

- Example FEA results file (3 hour timepoint): [GO_BP_3h_0.0001_4GF.csv](https://avigailtaylor.github.io/GeneFEAST/GO_BP_3h_0.0001_4GF.csv)
- Example FEA results file (24 hour timepoint): [GO_BP_24h_0.0001_4GF.csv](https://avigailtaylor.github.io/GeneFEAST/GO_BP_24h_0.0001_4GF.csv)
- Example genes of interest file (3 hour timepoint): [mmc2_goi_3h.csv](https://avigailtaylor.github.io/GeneFEAST/mmc2_goi_3h.csv)
- Example genes of interest file (24 hour timepoint): [mmc2_goi_3h.csv](https://avigailtaylor.github.io/GeneFEAST/mmc2_goi_24h.csv)
- Example extra annotation file: [mmc2_3h_24h_extra_annotations.txt](https://avigailtaylor.github.io/GeneFEAST/mmc2_goi_24h.csv)
- Example config file: [mmc2_3h_24h_config.yml](https://avigailtaylor.github.io/GeneFEAST/mmc2_3h_24h_config.yml)

---
### Download the following example meta-input file:

- Example meta-input file for multi FEA summary: [meta_3h_24h.txt](https://avigailtaylor.github.io/GeneFEAST/meta_3h_24h.txt)

> **IMPORTANT** Open this file and put in the full path to your copies of GO_BP_3h_0.0001_4GF.csv, mmc2_goi_3h.csv, GO_BP_24h_0.0001_4GF.csv, mmc2_goi_24h.csv

---
### Now run GeneFEAST in one of the following three ways:

Through its [docker](https://docs.docker.com/get-docker/) container:
```
docker run --volume $HOME:$HOME --workdir $(pwd) ghcr.io/avigailtaylor/genefeast:latest gf_multi <full/path/to/meta_3h_24h.txt> <OUTPUT_DIR> <full/path/to/mmc2_3h_24h_config.yml>
```

Through the command line:
```
    $ gf_multi <full/path/to/meta_3h_24h.txt> \
         <OUTPUT_DIR> \
         <full/path/to/mmc2_3h_24h_config.yml>
```

In Python:

```python
from genefeast import gf

gf.gf_multi(<full/path/to/meta_3h_24h.txt>, <OUTPUT_DIR>, <full/path/to/mmc2_3h_24h_config.yml>)
```
> In all three of these examples, `<OUTPUT_DIR>` can be whatever you want it to be, so long as it does not already exist.

---
### Comparing your output to the example output

Once you have run GeneFEAST, you can download [this example output](https://avigailtaylor.github.io/GeneFEAST/mmc2_3h_24h_output.zip), unzip it, and compare the output to your output.

#### Viewing the GeneFEAST report
To view the GeneFEAST HTML report, navigate to the output directory (specified by you in the `<OUTPUT_DIR>` parameter, above) and use a web browser to open
file `mmc2_3h_mmc2_24h_main.html`.

> **IMPORTANT**
> Viewing the HTML output report requires a web-browser with HTML5 and JavaScript 1.6 support.

> **IMPORTANT**
> Please make sure to keep all the output generated by GeneFEAST in the output directory; the HTML report uses relative links to images, and will break if the relative directory structure is broken.
> The same applies to [this example output](https://avigailtaylor.github.io/GeneFEAST/mmc2_3h_24h_output.zip) once you have unzipped it.

